





from gemini


### åœ¨ Hyprland ä¸­é…ç½®å¾®ä¿¡ç­‰è½¯ä»¶çš„é€šçŸ¥

Hyprland ä½œä¸º Wayland åˆæˆå™¨ï¼Œéœ€è¦å¤–éƒ¨é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹æ¥å¤„ç†åº”ç”¨é€šçŸ¥ã€‚å¾®ä¿¡ï¼ˆé€šå¸¸æŒ‡ WeChat for Linux æˆ– uos-wechat ç­‰ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ï¼‰é€šè¿‡ D-Bus å‘é€é€šçŸ¥ï¼Œä¸ Telegram ç±»ä¼¼ã€‚æ¨èä½¿ç”¨ **mako**ï¼ˆè½»é‡ Wayland åŸç”Ÿæ”¯æŒï¼‰æˆ– **dunst**ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´é…ç½®æ­¥éª¤ï¼ŒåŸºäº Arch Linuxï¼ˆå…¶ä»–å‘è¡Œç‰ˆè°ƒæ•´åŒ…ç®¡ç†å™¨å³å¯ï¼‰ã€‚

#### æ­¥éª¤ 1: å®‰è£…å¾®ä¿¡å’Œé€šçŸ¥å®ˆæŠ¤è¿›ç¨‹
- **å®‰è£…å¾®ä¿¡**ï¼š
  - å®˜æ–¹ WeChat for Linuxï¼ˆå¦‚æœå¯ç”¨ï¼‰ï¼šä» [è…¾è®¯å®˜ç½‘](https://weixin.qq.com/) ä¸‹è½½ .deb/.rpmï¼Œæˆ–ä½¿ç”¨ AURï¼š
    ```
    yay -S wechat-for-linux  # Arch/AUR ç”¨æˆ·
    # æˆ– flatpak install flathub com.qq.weixin.work
    ```
  - ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ï¼ˆå¦‚ wechat-uosï¼Œæ¨èç¨³å®šï¼‰ï¼š
    ```
    yay -S wechat-uos  # æˆ–ä» GitHub ä¸‹è½½
    ```
  - å®‰è£…åï¼Œåœ¨å¾®ä¿¡è®¾ç½®ä¸­å¯ç”¨é€šçŸ¥ï¼š**æˆ‘ > è®¾ç½® > é€šç”¨ > æ¶ˆæ¯é€šçŸ¥ > å¼€å¯æ–°æ¶ˆæ¯æé†’**ã€‚ç¦ç”¨â€œæ¶ˆæ¯æé†’æ—¶ç½®é¡¶çª—å£â€ä»¥é¿å…ç„¦ç‚¹åˆ‡æ¢ã€‚

- **å®‰è£…é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹**ï¼š
  ```
  sudo pacman -S mako  # æ¨è mako
  # æˆ– sudo pacman -S dunst  # å¤‡é€‰ dunst
  ```

#### æ­¥éª¤ 2: åœ¨ Hyprland é…ç½®ä¸­å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
ç¼–è¾‘ `~/.config/hypr/hyprland.conf`ï¼Œåœ¨ `exec-once` éƒ¨åˆ†æ·»åŠ ï¼š
```
exec-once = mako  # ä½¿ç”¨ mako
# æˆ– exec-once = dunst  # ä½¿ç”¨ dunst
```

é‡è½½é…ç½®ï¼š`Super + Shift + R` æˆ– `hyprctl reload`ã€‚

#### æ­¥éª¤ 3: é…ç½®é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹
å¾®ä¿¡é€šçŸ¥é€šå¸¸æ˜¾ç¤ºä¸ºâ€œæ–°æ¶ˆæ¯â€æ ‡é¢˜ + èŠå¤©å†…å®¹ã€‚è‡ªå®šä¹‰ä½ç½®ã€æ ·å¼ç­‰ã€‚

- **mako é…ç½®**ï¼ˆç®€å•æ¨èï¼‰ï¼š
  åˆ›å»º/ç¼–è¾‘ `~/.config/mako/config`ï¼š
  ```
  # å…¨å±€è®¾ç½®
  font=sans-serif 10
  background-color=#333333CC  # åŠé€æ˜èƒŒæ™¯
  text-color=#FFFFFF
  border-color=#FFFFFF
  border-size=2
  border-radius=10
  padding=10
  margin=10
  default-timeout=5000ms  # 5 ç§’æ˜¾ç¤º

  # ä½ç½®ï¼šå³ä¸Šè§’
  anchor=top-right
  layer=overlay

  # ç´§æ€¥é€šçŸ¥ï¼ˆå¾®ä¿¡é‡è¦æ¶ˆæ¯ï¼‰
  [urgency=high]
  default-timeout=0  # æ°¸ä¹…æ˜¾ç¤º
  ```
  - **å¾®ä¿¡ç‰¹å®šè§„åˆ™**ï¼ˆå¯é€‰ï¼ŒåŒ¹é… app_nameï¼‰ï¼š
    ```
    [app-name=WeChat]
    default-timeout=8000ms  # å¾®ä¿¡é€šçŸ¥æ˜¾ç¤º 8 ç§’
    ```

  æµ‹è¯•ï¼š`notify-send -a WeChat "æµ‹è¯•" "Hello from WeChat!"`ã€‚çœ‹åˆ°é€šçŸ¥å³æˆåŠŸã€‚

- **dunst é…ç½®**ï¼ˆå¦‚æœé€‰æ‹© dunstï¼‰ï¼š
  åˆ›å»º/ç¼–è¾‘ `~/.config/dunst/dunstrc`ï¼š
  ```
  # å…¨å±€è®¾ç½®
  font = sans-serif 10
  frame_color = "#FFFFFF"
  frame_width = 2
  padding = 10
  horizontal_padding = 10
  text_icon_padding = 10
  gap_size = 10

  # ä½ç½®ï¼šå³ä¸Šè§’
  alignment = center
  origin = top-right
  offset = 10x10

  # é¢œè‰²å’Œé€æ˜åº¦
  transparency = 10
  background = "#333333CC"
  foreground = "#FFFFFF"
  markup = full

  # æŒç»­æ—¶é—´
  timeout = 5

  # å¾®ä¿¡è§„åˆ™ï¼ˆåŒ¹é… app_name="WeChat" æˆ– "wechat-uos"ï¼‰
  [wechat]
  app_name = WeChat
  summary = "*"
  body = "*"
  icon = /usr/share/icons/hicolor/256x256/apps/wechat.png  # å¾®ä¿¡å›¾æ ‡è·¯å¾„ï¼ˆè°ƒæ•´ä¸ºå®é™…ï¼‰
  timeout = 8  # 8 ç§’
  urgency = normal
  ```
  æµ‹è¯•ï¼š`notify-send -a WeChat "æµ‹è¯•" "æ–°æ¶ˆæ¯!"`ã€‚é‡å¯ï¼š`pkill dunst`ã€‚

#### æ­¥éª¤ 4: å¤„ç†å¸¸è§é—®é¢˜
- **é€šçŸ¥ä¸æ˜¾ç¤º**ï¼š
  - æµ‹è¯• D-Busï¼š`notify-send "Test"`ã€‚
  - ç¡®ä¿å¾®ä¿¡åœ¨ Wayland æ¨¡å¼è¿è¡Œï¼šæ·»åŠ ç¯å¢ƒå˜é‡åˆ° `~/.profile`ï¼š
    ```
    export QT_QPA_PLATFORM=wayland
    export ELECTRON_OZONE_PLATFORM_HINT=auto  # å¦‚æœæ˜¯ Electron ç‰ˆå¾®ä¿¡
    ```
  - æ£€æŸ¥ app_nameï¼šè¿è¡Œå¾®ä¿¡æ—¶ï¼Œç”¨ `notify-send` æµ‹è¯•ä¸åŒåç§°ï¼ˆå¦‚ "WeChat" æˆ– "org.wechat"ï¼‰ï¼Œæˆ–ç”¨ `dbus-monitor` ç›‘æ§ï¼ˆ`dbus-monitor --session` å‘é€é€šçŸ¥è§‚å¯Ÿï¼‰ã€‚
  - Flatpak ç‰ˆå¾®ä¿¡ï¼šæ·»åŠ  `--socket=wayland` å¯åŠ¨ï¼š`flatpak run --socket=wayland com.qq.weixin.work`ã€‚

- **ç„¦ç‚¹åˆ‡æ¢æˆ–å·¥ä½œåŒºè·³è½¬**ï¼ˆå¾®ä¿¡å¸¸è§ï¼‰ï¼š
  - Hyprland é…ç½®æ·»åŠ ï¼š`misc { focus_on_activate = false }`ã€‚
  - çª—å£è§„åˆ™å¿½ç•¥å¾®ä¿¡ï¼š`windowrulev2 = nofocus,class:^(WeChat)$` æˆ– `windowrulev2 = workspace 10,class:^(WeChat)$`ï¼ˆå›ºå®šåˆ°å·¥ä½œåŒºï¼‰ã€‚
  - å¾®ä¿¡è®¾ç½®ä¸­ç¦ç”¨â€œæ–°æ¶ˆæ¯å¼¹çª—â€æˆ–â€œå£°éŸ³æé†’â€å¦‚æœå¹²æ‰°ã€‚

- **è‡ªå®šä¹‰å£°éŸ³**ï¼š
  - mako/dunst é…ç½®ä¸­æ·»åŠ  `sound-file=/usr/share/sounds/freedesktop/stereo/message.ogg`ï¼ˆå…¨å±€ï¼‰ã€‚
  - å¾®ä¿¡è‡ªå¸¦å£°éŸ³ï¼Œç¡®ä¿ PipeWire è¿è¡Œï¼š`systemctl --user start pipewire pipewire-pulse`ã€‚

- **é€šçŸ¥å†å²**ï¼ˆå¯é€‰ï¼‰ï¼š
  - å®‰è£… `swaync`ï¼š`sudo pacman -S swaync`ï¼ŒHyprland conf æ·»åŠ  `exec-once = swaync -g floating`ã€‚æä¾› GUI æŸ¥çœ‹/è¿‡æ»¤å¾®ä¿¡é€šçŸ¥ã€‚

#### æµ‹è¯•å¾®ä¿¡é€šçŸ¥
1. é‡å¯ Hyprlandã€‚
2. æ‰“å¼€å¾®ä¿¡ï¼Œè®©æœ‹å‹å‘æ¶ˆæ¯æˆ–è‡ªå‘æµ‹è¯•æ¶ˆæ¯ã€‚
3. å³ä¸Šè§’åº”å¼¹å‡ºé€šçŸ¥ï¼Œç‚¹å‡»å¯è·³è½¬èŠå¤©ã€‚

å¦‚æœå¾®ä¿¡æ˜¯ç‰¹å®šç‰ˆæœ¬ï¼ˆå¦‚ wechat-for-linuxï¼‰ï¼Œapp_name å¯èƒ½ä¸º "WeCom" æˆ– "WeChatWork"ï¼Œè°ƒæ•´è§„åˆ™ç›¸åº”ã€‚é—®é¢˜æ’æŸ¥ï¼šæŸ¥çœ‹ `hyprctl logs` æˆ– [Hyprland Wiki](https://wiki.hyprland.org/Useful-Utilities/Notification-Daemons/)ã€‚æ›´å¤šå¾®ä¿¡ Linux ç»†èŠ‚è§ [Arch Wiki](https://wiki.archlinux.org/title/WeChat)ã€‚é…ç½®ç±»ä¼¼å…¶ä»– IM åº”ç”¨ï¼











ğŸ‘Œ é‚£æˆ‘å¸®ä½ å†™ä¸€ä¸ª **è‡ªåŠ¨æ£€æµ‹å·¥å…·**ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾å‡ºæŸä¸ªåº”ç”¨çª—å£çš„ `class` å’Œå¯åŠ¨å‘½ä»¤ï¼Œæ–¹ä¾¿é…ç½®åˆ°è„šæœ¬é‡Œã€‚

---

## è„šæœ¬ï¼š`~/scripts/find-app-class.sh`

```bash
#!/usr/bin/env bash
set -euo pipefail

APP="${1:-}"

if [ -z "$APP" ]; then
  echo "ç”¨æ³•: $0 <å…³é”®å­—>"
  echo "ä¾‹å¦‚: $0 wechat"
  exit 1
fi

echo "æ­£åœ¨æŸ¥æ‰¾åŒ…å« '$APP' çš„çª—å£..."

hyprctl clients -j | jq -r --arg app "$APP" '
  .[]
  | select(
      (.class // "" | ascii_downcase | contains($app|ascii_downcase))
      or
      (.title // "" | ascii_downcase | contains($app|ascii_downcase))
    )
  | "class=\(.class)  title=\(.title)  address=\(.address)  ws=\(.workspace.id)"'
```

---

## ç”¨æ³•

```bash
chmod +x ~/scripts/find-app-class.sh
~/scripts/find-app-class.sh wechat
```

è¾“å‡ºç¤ºä¾‹ï¼ˆä¸åŒåº”ç”¨ä¼šä¸ä¸€æ ·ï¼‰ï¼š

```
class=WeChat.exe  title=å¾®ä¿¡  address=0x55a6f3b  ws=2
```

è¿™æ ·ä½ å°±çŸ¥é“ï¼š

- `class` æ˜¯ `WeChat.exe`ï¼Œé‚£ä¹ˆåœ¨ `toggle-app.sh` é‡Œä¼ å‚è¦å†™ `WeChat.exe`ï¼ˆå¤§å°å†™æ•æ„Ÿï¼ï¼‰ã€‚
    
- å¯åŠ¨å‘½ä»¤åˆ™æ˜¯ä½ å¹³æ—¶è¿è¡Œå¾®ä¿¡çš„å‘½ä»¤ï¼Œæ¯”å¦‚ `/opt/deepinwine/apps/Deepin-WeChat/wechat`ã€‚
    

---

## é…ç½® Hyprland ç»‘å®š

æ‹¿åˆ°ç»“æœåï¼Œæ¯”å¦‚ä½ å‘ç°å¾®ä¿¡çš„ class æ˜¯ `WeChat.exe`ï¼Œå°±å†™ï¼š

```ini
bind = SUPER, W, exec, ~/scripts/toggle-app.sh WeChat.exe "/opt/deepinwine/apps/Deepin-WeChat/wechat"
```

è¿™æ ·è„šæœ¬æ‰èƒ½æ­£ç¡®åŒ¹é…çª—å£ã€‚

---

è¦ä¸è¦æˆ‘é¡ºä¾¿å¸®ä½ åšä¸€ä¸ª **ä¸€é”®ç”Ÿæˆ Hyprland é…ç½®è¡Œ** çš„å°è„šæœ¬ï¼Ÿæ¯”å¦‚ä½ è¾“å…¥ `wechat /opt/deepinwine/apps/Deepin-WeChat/wechat`ï¼Œå®ƒå°±è‡ªåŠ¨è¾“å‡ºæ­£ç¡®çš„ `bind = ...` é…ç½®ã€‚
