---
layout: post
tags:
  - omarchy
---









### è‡ªåŠ¨æ£€æµ‹ç‰ˆè„šæœ¬

ä¿å­˜ä¸º `~/scripts/wechat-toggle.sh`ï¼š
```shell
#!/bin/bash

# è‡ªåŠ¨æ£€æµ‹å¾®ä¿¡çª—å£ class
get_wechat_class() {
    hyprctl clients | grep -i "wechat" | grep "class:" | head -n1 | awk '{print $2}'
}

WIN_CLASS=$(get_wechat_class)

# å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°ï¼Œé»˜è®¤ç”¨ wechat
if [ -z "$WIN_CLASS" ]; then
    WIN_CLASS="wechat"
fi

# æ£€æŸ¥å¾®ä¿¡æ˜¯å¦è¿è¡Œ
if ! pgrep -i wechat >/dev/null; then
    # æ²¡æœ‰è¿è¡Œå°±å¯åŠ¨
    wechat &
    exit 0
fi

# å¾®ä¿¡åœ¨è¿è¡Œï¼Œæ£€æŸ¥çª—å£ä¿¡æ¯
WIN_INFO=$(hyprctl clients | grep -i "class: $WIN_CLASS" -A 10)

if [ -z "$WIN_INFO" ]; then
    # æ²¡æ‰¾åˆ°çª—å£ï¼ˆå¯èƒ½åœ¨åå°ï¼‰ï¼Œé‡æ–°å¯åŠ¨
    wechat &
    exit 0
fi

# å¦‚æœçª—å£å·²èšç„¦ â†’ æœ€å°åŒ–åˆ°ä¸€ä¸ªéšè— workspace
if echo "$WIN_INFO" | grep -q "focused: yes"; then
    hyprctl dispatch movetoworkspacesilent special:hidden "class:^(?i)$WIN_CLASS$"
else
    # å¦åˆ™èšç„¦åˆ°å®ƒ
    hyprctl dispatch focuswindow "class:^(?i)$WIN_CLASS$"
fi
```


### ä½¿ç”¨æ–¹æ³•

1. ç»™æƒé™ï¼š
```shell
chmod +x ~/scripts/wechat-toggle.sh
```

2. åœ¨ `~/.config/hypr/hyprland.conf` é‡Œæ·»åŠ ï¼š
```shell
bind = SUPER, W, exec, ~/scripts/wechat-toggle.sh
```


è¿™æ ·æ•ˆæœå°±æ˜¯ï¼š

- `SUPER + W`
    
    - å¦‚æœå¾®ä¿¡æ²¡å¼€ â†’ å¯åŠ¨å¾®ä¿¡
        
    - å¦‚æœå¾®ä¿¡åœ¨åå° â†’ åˆ‡æ¢åˆ°å‰å°
        
    - å¦‚æœå¾®ä¿¡å·²åœ¨å‰å° â†’ éšè—åˆ°ä¸€ä¸ª `special:hidden` çš„ workspace




## ğŸ”¹ æ”¹è¿›åçš„ toggle è„šæœ¬ï¼ˆæ”¯æŒè·¨ workspaceï¼‰

ä¿å­˜ä¸º `~/scripts/toggle-app.sh`ï¼š


```shell
#!/bin/bash
APP=$1

# æ£€æŸ¥ç¨‹åºæ˜¯å¦è¿è¡Œ
if ! pgrep -x "$APP" >/dev/null; then
    $APP &
    exit 0
fi

# æŸ¥æ‰¾çª—å£ä¿¡æ¯
WIN_INFO=$(hyprctl clients | awk -v app="$APP" '
    BEGIN {IGNORECASE=1}
    /class:/ {cls=$2}
    /workspace:/ {ws=$2}
    /address:/ {addr=$2}
    /focused:/ {f=$2}
    {
      if (tolower(cls)==tolower(app)) {
        print cls, ws, addr, f
      }
    }')

if [ -z "$WIN_INFO" ]; then
    $APP &
    exit 0
fi

# è§£æç»“æœï¼ˆå–ç¬¬ä¸€ä¸ªåŒ¹é…çª—å£ï¼‰
read CLS WS ADDR FOCUSED <<< "$WIN_INFO"

if [ "$FOCUSED" == "yes" ]; then
    # å¦‚æœå·²èšç„¦ â†’ éšè—åˆ° special:hidden
    hyprctl dispatch movetoworkspacesilent special:hidden "class:^(?i)$APP$"
else
    if [ "$WS" != "$(hyprctl activeworkspace -j | jq -r .id)" ]; then
        # å¦‚æœåœ¨å…¶ä»– workspace â†’ åˆ‡è¿‡å»
        hyprctl dispatch workspace "$WS"
    fi
    # èšç„¦çª—å£
    hyprctl dispatch focuswindow "class:^(?i)$APP$"
fi

```



## ğŸ”¹ ä½¿ç”¨æ–¹å¼

1. ç»™æ‰§è¡Œæƒé™ï¼š
```shell
chmod +x ~/scripts/toggle-app.sh
```


2. åœ¨ ~/.config/hypr/hyprland.conf é‡Œé…ç½®ï¼š
```shell
bind = SUPER, W, exec, ~/scripts/toggle-app.sh wechat
bind = SUPER, T, exec, ~/scripts/toggle-app.sh telegram-desktop
bind = SUPER, B, exec, ~/scripts/toggle-app.sh firefox
bind = SUPER, Return, exec, ~/scripts/toggle-app.sh kitty
```


## ğŸ”¹ æ•ˆæœ

- å¦‚æœæ²¡è¿è¡Œ â†’ å¯åŠ¨
    
- å¦‚æœåœ¨å½“å‰ workspace â†’ èšç„¦æˆ–éšè—
    
- å¦‚æœåœ¨å…¶ä»– workspace â†’ è‡ªåŠ¨åˆ‡æ¢åˆ°å¯¹åº” workspace å¹¶èšç„¦
    
- å†æŒ‰ä¸€æ¬¡ â†’ éšè—åˆ° `special:hidden`


```
$(hyprctl clients | awk -v app="wechat" '
    BEGIN {IGNORECASE=1}
    /class:/ {cls=$2}
    /workspace:/ {ws=$2}
    /address:/ {addr=$2}
    /focused:/ {f=$2}
    {
      if (tolower(cls)==tolower(app)) {
        print cls, ws, addr, f
      }
    }')
    
    
    hyprctl clients -j | jq -r --arg app "wechat" '
    .[] | select(.class | ascii_downcase == ($app | ascii_downcase)) 
    | "\(.class) \(.workspace.id) \(.address)"' | head -n1
    
```