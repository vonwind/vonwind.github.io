<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>from Grok</p> <p>hyprland ä½¿ç”¨ä¸€ä¸ªè½¯ä»¶æ¯”å¦‚telegramé€šçŸ¥æ€ä¹ˆé…ç½®</p> <h3 id="åœ¨-hyprland-ä¸­é…ç½®å¾®ä¿¡ç­‰è½¯ä»¶çš„é€šçŸ¥">åœ¨ Hyprland ä¸­é…ç½®å¾®ä¿¡ç­‰è½¯ä»¶çš„é€šçŸ¥</h3> <p>Hyprland ä½œä¸º Wayland åˆæˆå™¨ï¼Œéœ€è¦å¤–éƒ¨é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹æ¥å¤„ç†åº”ç”¨é€šçŸ¥ã€‚å¾®ä¿¡ï¼ˆé€šå¸¸æŒ‡ WeChat for Linux æˆ– uos-wechat ç­‰ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ï¼‰é€šè¿‡ D-Bus å‘é€é€šçŸ¥ï¼Œä¸ Telegram ç±»ä¼¼ã€‚æ¨èä½¿ç”¨ <strong>mako</strong>ï¼ˆè½»é‡ Wayland åŸç”Ÿæ”¯æŒï¼‰æˆ– <strong>dunst</strong>ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´é…ç½®æ­¥éª¤ï¼ŒåŸºäº Arch Linuxï¼ˆå…¶ä»–å‘è¡Œç‰ˆè°ƒæ•´åŒ…ç®¡ç†å™¨å³å¯ï¼‰ã€‚</p> <h4 id="æ­¥éª¤-1-å®‰è£…å¾®ä¿¡å’Œé€šçŸ¥å®ˆæŠ¤è¿›ç¨‹">æ­¥éª¤ 1: å®‰è£…å¾®ä¿¡å’Œé€šçŸ¥å®ˆæŠ¤è¿›ç¨‹</h4> <ul> <li> <strong>å®‰è£…å¾®ä¿¡</strong>ï¼š <ul> <li>å®˜æ–¹ WeChat for Linuxï¼ˆå¦‚æœå¯ç”¨ï¼‰ï¼šä» <a href="https://weixin.qq.com/" rel="external nofollow noopener" target="_blank">è…¾è®¯å®˜ç½‘</a> ä¸‹è½½ .deb/.rpmï¼Œæˆ–ä½¿ç”¨ AURï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>yay -S wechat-for-linux  # Arch/AUR ç”¨æˆ·
# æˆ– flatpak install flathub com.qq.weixin.work
</code></pre></div> </div> </li> <li>ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ï¼ˆå¦‚ wechat-uosï¼Œæ¨èç¨³å®šï¼‰ï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>yay -S wechat-uos  # æˆ–ä» GitHub ä¸‹è½½
</code></pre></div> </div> </li> <li>å®‰è£…åï¼Œåœ¨å¾®ä¿¡è®¾ç½®ä¸­å¯ç”¨é€šçŸ¥ï¼š<strong>æˆ‘ &gt; è®¾ç½® &gt; é€šç”¨ &gt; æ¶ˆæ¯é€šçŸ¥ &gt; å¼€å¯æ–°æ¶ˆæ¯æé†’</strong>ã€‚ç¦ç”¨â€œæ¶ˆæ¯æé†’æ—¶ç½®é¡¶çª—å£â€ä»¥é¿å…ç„¦ç‚¹åˆ‡æ¢ã€‚</li> </ul> </li> <li> <strong>å®‰è£…é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹</strong>ï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>sudo pacman -S mako  # æ¨è mako
# æˆ– sudo pacman -S dunst  # å¤‡é€‰ dunst
</code></pre></div> </div> </li> </ul> <h4 id="æ­¥éª¤-2-åœ¨-hyprland-é…ç½®ä¸­å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹">æ­¥éª¤ 2: åœ¨ Hyprland é…ç½®ä¸­å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹</h4> <p>ç¼–è¾‘ <code class="language-plaintext highlighter-rouge">~/.config/hypr/hyprland.conf</code>ï¼Œåœ¨ <code class="language-plaintext highlighter-rouge">exec-once</code> éƒ¨åˆ†æ·»åŠ ï¼š</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exec-once = mako  # ä½¿ç”¨ mako
# æˆ– exec-once = dunst  # ä½¿ç”¨ dunst
</code></pre></div></div> <p>é‡è½½é…ç½®ï¼š<code class="language-plaintext highlighter-rouge">Super + Shift + R</code> æˆ– <code class="language-plaintext highlighter-rouge">hyprctl reload</code>ã€‚</p> <h4 id="æ­¥éª¤-3-é…ç½®é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹">æ­¥éª¤ 3: é…ç½®é€šçŸ¥å®ˆæŠ¤è¿›ç¨‹</h4> <p>å¾®ä¿¡é€šçŸ¥é€šå¸¸æ˜¾ç¤ºä¸ºâ€œæ–°æ¶ˆæ¯â€æ ‡é¢˜ + èŠå¤©å†…å®¹ã€‚è‡ªå®šä¹‰ä½ç½®ã€æ ·å¼ç­‰ã€‚</p> <ul> <li> <strong>mako é…ç½®</strong>ï¼ˆç®€å•æ¨èï¼‰ï¼š åˆ›å»º/ç¼–è¾‘ <code class="language-plaintext highlighter-rouge">~/.config/mako/config</code>ï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code># å…¨å±€è®¾ç½®
font=sans-serif 10
background-color=#333333CC  # åŠé€æ˜èƒŒæ™¯
text-color=#FFFFFF
border-color=#FFFFFF
border-size=2
border-radius=10
padding=10
margin=10
default-timeout=5000ms  # 5 ç§’æ˜¾ç¤º

# ä½ç½®ï¼šå³ä¸Šè§’
anchor=top-right
layer=overlay

# ç´§æ€¥é€šçŸ¥ï¼ˆå¾®ä¿¡é‡è¦æ¶ˆæ¯ï¼‰
[urgency=high]
default-timeout=0  # æ°¸ä¹…æ˜¾ç¤º
</code></pre></div> </div> <ul> <li> <strong>å¾®ä¿¡ç‰¹å®šè§„åˆ™</strong>ï¼ˆå¯é€‰ï¼ŒåŒ¹é… app_nameï¼‰ï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>[app-name=WeChat]
default-timeout=8000ms  # å¾®ä¿¡é€šçŸ¥æ˜¾ç¤º 8 ç§’
</code></pre></div> </div> </li> </ul> <p>æµ‹è¯•ï¼š<code class="language-plaintext highlighter-rouge">notify-send -a WeChat "æµ‹è¯•" "Hello from WeChat!"</code>ã€‚çœ‹åˆ°é€šçŸ¥å³æˆåŠŸã€‚</p> </li> <li> <strong>dunst é…ç½®</strong>ï¼ˆå¦‚æœé€‰æ‹© dunstï¼‰ï¼š åˆ›å»º/ç¼–è¾‘ <code class="language-plaintext highlighter-rouge">~/.config/dunst/dunstrc</code>ï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code># å…¨å±€è®¾ç½®
font = sans-serif 10
frame_color = "#FFFFFF"
frame_width = 2
padding = 10
horizontal_padding = 10
text_icon_padding = 10
gap_size = 10

# ä½ç½®ï¼šå³ä¸Šè§’
alignment = center
origin = top-right
offset = 10x10

# é¢œè‰²å’Œé€æ˜åº¦
transparency = 10
background = "#333333CC"
foreground = "#FFFFFF"
markup = full

# æŒç»­æ—¶é—´
timeout = 5

# å¾®ä¿¡è§„åˆ™ï¼ˆåŒ¹é… app_name="WeChat" æˆ– "wechat-uos"ï¼‰
[wechat]
app_name = WeChat
summary = "*"
body = "*"
icon = /usr/share/icons/hicolor/256x256/apps/wechat.png  # å¾®ä¿¡å›¾æ ‡è·¯å¾„ï¼ˆè°ƒæ•´ä¸ºå®é™…ï¼‰
timeout = 8  # 8 ç§’
urgency = normal
</code></pre></div> </div> <p>æµ‹è¯•ï¼š<code class="language-plaintext highlighter-rouge">notify-send -a WeChat "æµ‹è¯•" "æ–°æ¶ˆæ¯!"</code>ã€‚é‡å¯ï¼š<code class="language-plaintext highlighter-rouge">pkill dunst</code>ã€‚</p> </li> </ul> <h4 id="æ­¥éª¤-4-å¤„ç†å¸¸è§é—®é¢˜">æ­¥éª¤ 4: å¤„ç†å¸¸è§é—®é¢˜</h4> <ul> <li> <strong>é€šçŸ¥ä¸æ˜¾ç¤º</strong>ï¼š <ul> <li>æµ‹è¯• D-Busï¼š<code class="language-plaintext highlighter-rouge">notify-send "Test"</code>ã€‚</li> <li>ç¡®ä¿å¾®ä¿¡åœ¨ Wayland æ¨¡å¼è¿è¡Œï¼šæ·»åŠ ç¯å¢ƒå˜é‡åˆ° <code class="language-plaintext highlighter-rouge">~/.profile</code>ï¼š <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>export QT_QPA_PLATFORM=wayland
export ELECTRON_OZONE_PLATFORM_HINT=auto  # å¦‚æœæ˜¯ Electron ç‰ˆå¾®ä¿¡
</code></pre></div> </div> </li> <li>æ£€æŸ¥ app_nameï¼šè¿è¡Œå¾®ä¿¡æ—¶ï¼Œç”¨ <code class="language-plaintext highlighter-rouge">notify-send</code> æµ‹è¯•ä¸åŒåç§°ï¼ˆå¦‚ â€œWeChatâ€ æˆ– â€œorg.wechatâ€ï¼‰ï¼Œæˆ–ç”¨ <code class="language-plaintext highlighter-rouge">dbus-monitor</code> ç›‘æ§ï¼ˆ<code class="language-plaintext highlighter-rouge">dbus-monitor --session</code> å‘é€é€šçŸ¥è§‚å¯Ÿï¼‰ã€‚</li> <li>Flatpak ç‰ˆå¾®ä¿¡ï¼šæ·»åŠ  <code class="language-plaintext highlighter-rouge">--socket=wayland</code> å¯åŠ¨ï¼š<code class="language-plaintext highlighter-rouge">flatpak run --socket=wayland com.qq.weixin.work</code>ã€‚</li> </ul> </li> <li> <strong>ç„¦ç‚¹åˆ‡æ¢æˆ–å·¥ä½œåŒºè·³è½¬</strong>ï¼ˆå¾®ä¿¡å¸¸è§ï¼‰ï¼š <ul> <li>Hyprland é…ç½®æ·»åŠ ï¼š<code class="language-plaintext highlighter-rouge">misc { focus_on_activate = false }</code>ã€‚</li> <li>çª—å£è§„åˆ™å¿½ç•¥å¾®ä¿¡ï¼š<code class="language-plaintext highlighter-rouge">windowrulev2 = nofocus,class:^(WeChat)$</code> æˆ– <code class="language-plaintext highlighter-rouge">windowrulev2 = workspace 10,class:^(WeChat)$</code>ï¼ˆå›ºå®šåˆ°å·¥ä½œåŒºï¼‰ã€‚</li> <li>å¾®ä¿¡è®¾ç½®ä¸­ç¦ç”¨â€œæ–°æ¶ˆæ¯å¼¹çª—â€æˆ–â€œå£°éŸ³æé†’â€å¦‚æœå¹²æ‰°ã€‚</li> </ul> </li> <li> <strong>è‡ªå®šä¹‰å£°éŸ³</strong>ï¼š <ul> <li>mako/dunst é…ç½®ä¸­æ·»åŠ  <code class="language-plaintext highlighter-rouge">sound-file=/usr/share/sounds/freedesktop/stereo/message.ogg</code>ï¼ˆå…¨å±€ï¼‰ã€‚</li> <li>å¾®ä¿¡è‡ªå¸¦å£°éŸ³ï¼Œç¡®ä¿ PipeWire è¿è¡Œï¼š<code class="language-plaintext highlighter-rouge">systemctl --user start pipewire pipewire-pulse</code>ã€‚</li> </ul> </li> <li> <strong>é€šçŸ¥å†å²</strong>ï¼ˆå¯é€‰ï¼‰ï¼š <ul> <li>å®‰è£… <code class="language-plaintext highlighter-rouge">swaync</code>ï¼š<code class="language-plaintext highlighter-rouge">sudo pacman -S swaync</code>ï¼ŒHyprland conf æ·»åŠ  <code class="language-plaintext highlighter-rouge">exec-once = swaync -g floating</code>ã€‚æä¾› GUI æŸ¥çœ‹/è¿‡æ»¤å¾®ä¿¡é€šçŸ¥ã€‚</li> </ul> </li> </ul> <h4 id="æµ‹è¯•å¾®ä¿¡é€šçŸ¥">æµ‹è¯•å¾®ä¿¡é€šçŸ¥</h4> <ol> <li>é‡å¯ Hyprlandã€‚</li> <li>æ‰“å¼€å¾®ä¿¡ï¼Œè®©æœ‹å‹å‘æ¶ˆæ¯æˆ–è‡ªå‘æµ‹è¯•æ¶ˆæ¯ã€‚</li> <li>å³ä¸Šè§’åº”å¼¹å‡ºé€šçŸ¥ï¼Œç‚¹å‡»å¯è·³è½¬èŠå¤©ã€‚</li> </ol> <p>å¦‚æœå¾®ä¿¡æ˜¯ç‰¹å®šç‰ˆæœ¬ï¼ˆå¦‚ wechat-for-linuxï¼‰ï¼Œapp_name å¯èƒ½ä¸º â€œWeComâ€ æˆ– â€œWeChatWorkâ€ï¼Œè°ƒæ•´è§„åˆ™ç›¸åº”ã€‚é—®é¢˜æ’æŸ¥ï¼šæŸ¥çœ‹ <code class="language-plaintext highlighter-rouge">hyprctl logs</code> æˆ– <a href="https://wiki.hyprland.org/Useful-Utilities/Notification-Daemons/" rel="external nofollow noopener" target="_blank">Hyprland Wiki</a>ã€‚æ›´å¤šå¾®ä¿¡ Linux ç»†èŠ‚è§ <a href="https://wiki.archlinux.org/title/WeChat" rel="external nofollow noopener" target="_blank">Arch Wiki</a>ã€‚é…ç½®ç±»ä¼¼å…¶ä»– IM åº”ç”¨ï¼</p> <p>ğŸ‘Œ é‚£æˆ‘å¸®ä½ å†™ä¸€ä¸ª <strong>è‡ªåŠ¨æ£€æµ‹å·¥å…·</strong>ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾å‡ºæŸä¸ªåº”ç”¨çª—å£çš„ <code class="language-plaintext highlighter-rouge">class</code> å’Œå¯åŠ¨å‘½ä»¤ï¼Œæ–¹ä¾¿é…ç½®åˆ°è„šæœ¬é‡Œã€‚</p> <hr> <h2 id="è„šæœ¬scriptsfind-app-classsh">è„šæœ¬ï¼š<code class="language-plaintext highlighter-rouge">~/scripts/find-app-class.sh</code> </h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-}</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"ç”¨æ³•: </span><span class="nv">$0</span><span class="s2"> &lt;å…³é”®å­—&gt;"</span>
  <span class="nb">echo</span> <span class="s2">"ä¾‹å¦‚: </span><span class="nv">$0</span><span class="s2"> wechat"</span>
  <span class="nb">exit </span>1
<span class="k">fi

</span><span class="nb">echo</span> <span class="s2">"æ­£åœ¨æŸ¥æ‰¾åŒ…å« '</span><span class="nv">$APP</span><span class="s2">' çš„çª—å£..."</span>

hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[]
  | select(
      (.class // "" | ascii_downcase | contains($app|ascii_downcase))
      or
      (.title // "" | ascii_downcase | contains($app|ascii_downcase))
    )
  | "class=\(.class)  title=\(.title)  address=\(.address)  ws=\(.workspace.id)"'</span>
</code></pre></div></div> <hr> <h2 id="ç”¨æ³•">ç”¨æ³•</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x ~/scripts/find-app-class.sh
~/scripts/find-app-class.sh wechat
</code></pre></div></div> <p>è¾“å‡ºç¤ºä¾‹ï¼ˆä¸åŒåº”ç”¨ä¼šä¸ä¸€æ ·ï¼‰ï¼š</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class=WeChat.exe  title=å¾®ä¿¡  address=0x55a6f3b  ws=2
</code></pre></div></div> <p>è¿™æ ·ä½ å°±çŸ¥é“ï¼š</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">class</code> æ˜¯ <code class="language-plaintext highlighter-rouge">WeChat.exe</code>ï¼Œé‚£ä¹ˆåœ¨ <code class="language-plaintext highlighter-rouge">toggle-app.sh</code> é‡Œä¼ å‚è¦å†™ <code class="language-plaintext highlighter-rouge">WeChat.exe</code>ï¼ˆå¤§å°å†™æ•æ„Ÿï¼ï¼‰ã€‚</p> </li> <li> <p>å¯åŠ¨å‘½ä»¤åˆ™æ˜¯ä½ å¹³æ—¶è¿è¡Œå¾®ä¿¡çš„å‘½ä»¤ï¼Œæ¯”å¦‚ <code class="language-plaintext highlighter-rouge">/opt/deepinwine/apps/Deepin-WeChat/wechat</code>ã€‚</p> </li> </ul> <hr> <h2 id="é…ç½®-hyprland-ç»‘å®š">é…ç½® Hyprland ç»‘å®š</h2> <p>æ‹¿åˆ°ç»“æœåï¼Œæ¯”å¦‚ä½ å‘ç°å¾®ä¿¡çš„ class æ˜¯ <code class="language-plaintext highlighter-rouge">WeChat.exe</code>ï¼Œå°±å†™ï¼š</p> <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">bind</span> <span class="p">=</span> <span class="s">SUPER, W, exec, ~/scripts/toggle-app.sh WeChat.exe "/opt/deepinwine/apps/Deepin-WeChat/wechat"</span>
</code></pre></div></div> <p>è¿™æ ·è„šæœ¬æ‰èƒ½æ­£ç¡®åŒ¹é…çª—å£ã€‚</p> <hr> <p>è¦ä¸è¦æˆ‘é¡ºä¾¿å¸®ä½ åšä¸€ä¸ª <strong>ä¸€é”®ç”Ÿæˆ Hyprland é…ç½®è¡Œ</strong> çš„å°è„šæœ¬ï¼Ÿæ¯”å¦‚ä½ è¾“å…¥ <code class="language-plaintext highlighter-rouge">wechat /opt/deepinwine/apps/Deepin-WeChat/wechat</code>ï¼Œå®ƒå°±è‡ªåŠ¨è¾“å‡ºæ­£ç¡®çš„ <code class="language-plaintext highlighter-rouge">bind = ...</code> é…ç½®ã€‚</p> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> </body></html>