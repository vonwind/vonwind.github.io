<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Hyprland微信快捷键 | Kevin Feng </title> <meta name="author" content="Kevin Feng"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%BF&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://vonwind.github.io/blog/2025/Hyprland%E5%BE%AE%E4%BF%A1%E5%BF%AB%E6%8D%B7%E9%94%AE/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kevin</span> Feng </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Hyprland微信快捷键</h1> <p class="post-meta"> Created on September 22, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/omarchy"> <i class="fa-solid fa-hashtag fa-sm"></i> omarchy</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="自动检测版脚本">自动检测版脚本</h3> <p>保存为 <code class="language-plaintext highlighter-rouge">~/scripts/wechat-toggle.sh</code>：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="c"># 自动检测微信窗口 class</span>
get_wechat_class<span class="o">()</span> <span class="o">{</span>
    hyprctl clients | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"wechat"</span> | <span class="nb">grep</span> <span class="s2">"class:"</span> | <span class="nb">head</span> <span class="nt">-n1</span> | <span class="nb">awk</span> <span class="s1">'{print $2}'</span>
<span class="o">}</span>

<span class="nv">WIN_CLASS</span><span class="o">=</span><span class="si">$(</span>get_wechat_class<span class="si">)</span>

<span class="c"># 如果没有检测到，默认用 wechat</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$WIN_CLASS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nv">WIN_CLASS</span><span class="o">=</span><span class="s2">"wechat"</span>
<span class="k">fi</span>

<span class="c"># 检查微信是否运行</span>
<span class="k">if</span> <span class="o">!</span> pgrep <span class="nt">-i</span> wechat <span class="o">&gt;</span>/dev/null<span class="p">;</span> <span class="k">then</span>
    <span class="c"># 没有运行就启动</span>
    wechat &amp;
    <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 微信在运行，检查窗口信息</span>
<span class="nv">WIN_INFO</span><span class="o">=</span><span class="si">$(</span>hyprctl clients | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"class: </span><span class="nv">$WIN_CLASS</span><span class="s2">"</span> <span class="nt">-A</span> 10<span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c"># 没找到窗口（可能在后台），重新启动</span>
    wechat &amp;
    <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 如果窗口已聚焦 → 最小化到一个隐藏 workspace</span>
<span class="k">if </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s2">"focused: yes"</span><span class="p">;</span> <span class="k">then
    </span>hyprctl dispatch movetoworkspacesilent special:hidden <span class="s2">"class:^(?i)</span><span class="nv">$WIN_CLASS</span><span class="s2">$"</span>
<span class="k">else</span>
    <span class="c"># 否则聚焦到它</span>
    hyprctl dispatch focuswindow <span class="s2">"class:^(?i)</span><span class="nv">$WIN_CLASS</span><span class="s2">$"</span>
<span class="k">fi</span>
</code></pre></div></div> <h3 id="使用方法">使用方法</h3> <ol> <li>给权限： <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x ~/scripts/wechat-toggle.sh
</code></pre></div> </div> </li> <li>在 <code class="language-plaintext highlighter-rouge">~/.config/hypr/hyprland.conf</code> 里添加： <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/wechat-toggle.sh
</code></pre></div> </div> </li> </ol> <p>这样效果就是：</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">SUPER + W</code></p> <ul> <li> <p>如果微信没开 → 启动微信</p> </li> <li> <p>如果微信在后台 → 切换到前台</p> </li> <li> <p>如果微信已在前台 → 隐藏到一个 <code class="language-plaintext highlighter-rouge">special:hidden</code> 的 workspace</p> </li> </ul> </li> </ul> <h2 id="-改进后的-toggle-脚本支持跨-workspace">🔹 改进后的 toggle 脚本（支持跨 workspace）</h2> <p>保存为 <code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code>：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nv">APP</span><span class="o">=</span><span class="nv">$1</span>

<span class="c"># 检查程序是否运行</span>
<span class="k">if</span> <span class="o">!</span> pgrep <span class="nt">-x</span> <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null<span class="p">;</span> <span class="k">then</span>
    <span class="nv">$APP</span> &amp;
    <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 查找窗口信息</span>
<span class="nv">WIN_INFO</span><span class="o">=</span><span class="si">$(</span>hyprctl clients | <span class="nb">awk</span> <span class="nt">-v</span> <span class="nv">app</span><span class="o">=</span><span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
    BEGIN {IGNORECASE=1}
    /class:/ {cls=$2}
    /workspace:/ {ws=$2}
    /address:/ {addr=$2}
    /focused:/ {f=$2}
    {
      if (tolower(cls)==tolower(app)) {
        print cls, ws, addr, f
      }
    }'</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">$APP</span> &amp;
    <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 解析结果（取第一个匹配窗口）</span>
<span class="nb">read </span>CLS WS ADDR FOCUSED <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$FOCUSED</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"yes"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c"># 如果已聚焦 → 隐藏到 special:hidden</span>
    hyprctl dispatch movetoworkspacesilent special:hidden <span class="s2">"class:^(?i)</span><span class="nv">$APP</span><span class="s2">$"</span>
<span class="k">else
    if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">"</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="c"># 如果在其他 workspace → 切过去</span>
        hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span>
    <span class="k">fi</span>
    <span class="c"># 聚焦窗口</span>
    hyprctl dispatch focuswindow <span class="s2">"class:^(?i)</span><span class="nv">$APP</span><span class="s2">$"</span>
<span class="k">fi</span>

</code></pre></div></div> <h2 id="-使用方式">🔹 使用方式</h2> <ol> <li>给执行权限： <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x ~/scripts/toggle-app.sh
</code></pre></div> </div> </li> <li>在 ~/.config/hypr/hyprland.conf 里配置： <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh wechat
<span class="nb">bind</span> <span class="o">=</span> SUPER, T, <span class="nb">exec</span>, ~/scripts/toggle-app.sh telegram-desktop
<span class="nb">bind</span> <span class="o">=</span> SUPER, B, <span class="nb">exec</span>, ~/scripts/toggle-app.sh firefox
<span class="nb">bind</span> <span class="o">=</span> SUPER, Return, <span class="nb">exec</span>, ~/scripts/toggle-app.sh kitty
</code></pre></div> </div> </li> </ol> <h2 id="-效果">🔹 效果</h2> <ul> <li> <p>如果没运行 → 启动</p> </li> <li> <p>如果在当前 workspace → 聚焦或隐藏</p> </li> <li> <p>如果在其他 workspace → 自动切换到对应 workspace 并聚焦</p> </li> <li> <p>再按一次 → 隐藏到 <code class="language-plaintext highlighter-rouge">special:hidden</code></p> </li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$(hyprctl clients | awk -v app="wechat" '
    BEGIN {IGNORECASE=1}
    /class:/ {cls=$2}
    /workspace:/ {ws=$2}
    /address:/ {addr=$2}
    /focused:/ {f=$2}
    {
      if (tolower(cls)==tolower(app)) {
        print cls, ws, addr, f
      }
    }')
    
    
    hyprctl clients -j | jq -r --arg app "wechat" '
    .[] | select(.class | ascii_downcase == ($app | ascii_downcase)) 
    | "\(.class) \(.workspace.id) \(.address)"' | head -n1
    
</code></pre></div></div> <p>没有focused</p> <p>啊，明白了 👍。<br> 你在 <code class="language-plaintext highlighter-rouge">hyprctl clients</code> 里看到的输出里 <strong>没有 <code class="language-plaintext highlighter-rouge">focused:</code> 字段</strong>，这是因为 Hyprland 在不同版本里 <code class="language-plaintext highlighter-rouge">clients</code> 的输出格式变过。</p> <p>有的版本里 <code class="language-plaintext highlighter-rouge">hyprctl clients</code> 输出的是：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class: firefox
title: Mozilla Firefox
workspace: 2
address: 0x55d9e6e
at: 1920,30
...
focusHistoryID: 12

</code></pre></div></div> <p>没有 <code class="language-plaintext highlighter-rouge">focused: yes/no</code>。<br> 要判断某个窗口是不是前台，就要<strong>对比它的 workspace 和当前活动的 workspace</strong>。</p> <h2 id="-改进版兼容没有-focused-字段的情况">🔹 改进版（兼容没有 <code class="language-plaintext highlighter-rouge">focused</code> 字段的情况）</h2> <p>更新后的 <code class="language-plaintext highlighter-rouge">toggle-app.sh</code>：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nv">APP</span><span class="o">=</span><span class="nv">$1</span>

<span class="c"># 检查程序是否运行</span>
<span class="k">if</span> <span class="o">!</span> pgrep <span class="nt">-x</span> <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null<span class="p">;</span> <span class="k">then</span>
    <span class="nv">$APP</span> &amp;
    <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 当前 workspace ID</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>

<span class="c"># 查找第一个匹配的窗口</span>
<span class="nv">WIN_INFO</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
    .[] | select(.class | ascii_downcase == ($app | ascii_downcase)) 
    | "\(.class) \(.workspace.id) \(.address)"'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">$APP</span> &amp;
    <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nb">read </span>CLS WS ADDR <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c"># 如果在当前 workspace → 隐藏到 special:hidden</span>
    hyprctl dispatch movetoworkspacesilent special:hidden <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
<span class="k">else</span>
    <span class="c"># 如果在其他 workspace → 切换并聚焦</span>
    hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span>
    hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
<span class="k">fi</span>

</code></pre></div></div> <h2 id="-关键点">🔹 关键点</h2> <ul> <li> <p>这里用 <code class="language-plaintext highlighter-rouge">hyprctl clients -j</code>（JSON 格式），再用 <code class="language-plaintext highlighter-rouge">jq</code> 解析：</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">.class</code> → 应用类名</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">.workspace.id</code> → 窗口所在的 workspace</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">.address</code> → 窗口地址（唯一 ID）</p> </li> </ul> </li> <li> <p>判断逻辑改成：</p> <ul> <li> <p><strong>在当前 workspace</strong> → 隐藏到 <code class="language-plaintext highlighter-rouge">special:hidden</code></p> </li> <li> <p><strong>在其他 workspace</strong> → 切换过去并聚焦</p> </li> </ul> </li> </ul> <h2 id="-配置方式">🔹 配置方式</h2> <p>同样在 <code class="language-plaintext highlighter-rouge">hyprland.conf</code> 里写：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh wechat
<span class="nb">bind</span> <span class="o">=</span> SUPER, T, <span class="nb">exec</span>, ~/scripts/toggle-app.sh telegram-desktop
<span class="nb">bind</span> <span class="o">=</span> SUPER, B, <span class="nb">exec</span>, ~/scripts/toggle-app.sh firefox

</code></pre></div></div> <p>这样就不会依赖 <code class="language-plaintext highlighter-rouge">focused</code> 字段了 ✅。</p> <hr> <p>隐藏后再打开 不平铺窗口</p> <p>👌 你说的情况是：<br> 脚本里把窗口 <strong>移到 <code class="language-plaintext highlighter-rouge">special:hidden</code></strong> workspace 之后，再切回来时，窗口不是平铺状态了（比如变成浮动、尺寸乱掉）。</p> <p>这是因为：</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">special:hidden</code> 本身是一个 <strong>特殊 workspace</strong>，窗口切进去切出来时，Hyprland 可能会改变它的 <strong>tiling/floating 状态</strong>。</p> </li> <li> <p>另外，<code class="language-plaintext highlighter-rouge">hyprctl dispatch movetoworkspacesilent</code> 没有强制保持 tiling。</p> </li> </ul> <h2 id="-解决思路">🔹 解决思路</h2> <ol> <li> <p><strong>记录窗口原本的状态</strong>（tiling/floating）。</p> </li> <li> <p>隐藏时 → 移到 <code class="language-plaintext highlighter-rouge">special:hidden</code>。</p> </li> <li> <p>再显示时 → 把它移回原来的 workspace，并恢复 tiling 状态。</p> </li> </ol> <h2 id="-改进脚本保证窗口恢复平铺">🔹 改进脚本：保证窗口恢复平铺</h2> <p>保存为 <code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code>：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nv">APP</span><span class="o">=</span><span class="nv">$1</span>

<span class="nv">STATE_FILE</span><span class="o">=</span><span class="s2">"/tmp/hypr_toggle_</span><span class="k">${</span><span class="nv">APP</span><span class="k">}</span><span class="s2">.state"</span>

<span class="c"># 检查程序是否运行</span>
<span class="k">if</span> <span class="o">!</span> pgrep <span class="nt">-x</span> <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null<span class="p">;</span> <span class="k">then</span>
    <span class="nv">$APP</span> &amp;
    <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>

<span class="c"># 找窗口信息</span>
<span class="nv">WIN_INFO</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
    .[] | select(.class | ascii_downcase == ($app | ascii_downcase))
    | "\(.workspace.id) \(.address) \(.floating)"'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">$APP</span> &amp;
    <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nb">read </span>WS ADDR FLOATING <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$WIN_INFO</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c"># 已在当前 workspace → 隐藏</span>
    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2"> </span><span class="nv">$FLOATING</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
    hyprctl dispatch movetoworkspacesilent special:hidden <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
<span class="k">else
    if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"special:hidden"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="c"># 从隐藏恢复 → 移回原 workspace</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">read </span>OLD_WS OLD_FLOATING &lt; <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
            hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="nv">$OLD_WS</span><span class="s2">"</span> <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
            <span class="c"># 恢复 tiling 状态</span>
            <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$OLD_FLOATING</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"false"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
                </span>hyprctl dispatch toggletiling <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
            <span class="k">fi
            </span><span class="nb">rm</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
        <span class="k">else
            </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
        <span class="k">fi
    else</span>
        <span class="c"># 在其他 workspace → 切过去并聚焦</span>
        hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$WS</span><span class="s2">"</span>
        hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="nv">$ADDR</span><span class="s2">"</span>
    <span class="k">fi
fi</span>

</code></pre></div></div> <h2 id="-逻辑说明">🔹 逻辑说明</h2> <ul> <li> <p>第一次隐藏时 → 把 <strong>原 workspace + 是否浮动</strong> 写到 <code class="language-plaintext highlighter-rouge">/tmp/hypr_toggle_APP.state</code>。</p> </li> <li> <p>再次切换时 → 如果窗口在 <code class="language-plaintext highlighter-rouge">special:hidden</code>，就：</p> <ol> <li> <p>移回原 workspace</p> </li> <li> <p>如果之前是 tiling → 强制 <code class="language-plaintext highlighter-rouge">toggletiling</code>，保证不是浮动。</p> </li> </ol> </li> </ul> <p>这样你就能做到：</p> <ul> <li> <p><strong>按快捷键 → 隐藏</strong>（移到 hidden）</p> </li> <li> <p><strong>再按一次 → 恢复到原 workspace，并保持平铺</strong></p> </li> </ul> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>这样改都不能隐藏了</p> <p>Thought for 1m 13s</p> <p>好——没关系，我们一步步把它修好。你说“这样改都不能隐藏了”，<strong>最常见的原因</strong>有两条，我先把原因说清楚再给你一个实战可用的脚本（含调试日志、回退策略），你直接替换试一下：</p> <p>原因总结（简短）</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">movetoworkspacesilent</code> + <code class="language-plaintext highlighter-rouge">special</code> 的组合在不同 Hyprland 版本/实现上行为不稳定或未完全支持，社区里有相关 report（所以直接用 <code class="language-plaintext highlighter-rouge">movetoworkspacesilent "special,..."</code> 可能没作用）。<a href="https://github.com/hyprwm/Hyprland/issues/1452?utm_source=chatgpt.com" rel="external nofollow noopener" target="_blank">GitHub</a></p> </li> <li> <p>Special workspace 本身有一些限制（例如 special 的浮动/tiling 行为和普通 workspace 不完全一样），window 在 special 与恢复时状态会被 compositor 改变。文档也指出 special 的行为与普通 workspace 不同。<a href="https://wiki.hypr.land/0.18.0beta/Configuring/Dispatchers/?utm_source=chatgpt.com" rel="external nofollow noopener" target="_blank">Hyprland Wiki</a></p> </li> </ul> <p>因此我们要做两件事：</p> <ol> <li> <p>把隐藏逻辑做得更<strong>稳健</strong>（先尝试最优 API，失败就降级到可靠的 workaround）；</p> </li> <li> <p>回显（恢复）时<strong>明确用 <code class="language-plaintext highlighter-rouge">address:</code> 指定窗口</strong>并在必要时做二次恢复（防止被动成浮动）。</p> </li> </ol> <h1 id="推荐脚本带调试--回退">推荐脚本（带调试 + 回退）</h1> <p>把下面保存为 <code class="language-plaintext highlighter-rouge">~/scripts/wechat-toggle.sh</code>（或你原来的脚本名），并 <code class="language-plaintext highlighter-rouge">chmod +x</code>。这个脚本会记录日志 <code class="language-plaintext highlighter-rouge">/tmp/hypr_toggle_debug.log</code>，并尝试多种方式来隐藏/恢复（先试 silent，失败就用 movetoworkspace+切回 的 fallback）：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail
<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">STATE_DIR</span><span class="o">=</span><span class="s2">"/tmp/hypr_toggle_states"</span>
<span class="nv">LOG</span><span class="o">=</span><span class="s2">"/tmp/hypr_toggle_debug.log"</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">"</span>
: <span class="o">&gt;</span><span class="s2">"</span><span class="nv">$LOG</span><span class="s2">"</span>

dbg<span class="o">(){</span> <span class="nb">echo</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">date</span> +%T<span class="si">)</span><span class="s2"> </span><span class="nv">$*</span><span class="s2">"</span> <span class="o">&gt;&gt;</span><span class="s2">"</span><span class="nv">$LOG</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>

<span class="c"># find first matching window's address</span>
<span class="nv">WIN_JSON</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span> 2&gt;/dev/null <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"[]"</span><span class="si">)</span>
<span class="nv">ADDR</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[] | select((.class // "" | ascii_downcase) == ($app|ascii_downcase)) | .address'</span> | <span class="nb">head</span> <span class="nt">-n1</span> <span class="o">||</span> <span class="nb">true</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"null"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span>dbg <span class="s2">"No running window for '</span><span class="nv">$APP</span><span class="s2">' found. Starting it."</span>
  <span class="c"># 修改为你的启动命令（如果可执行名不同）</span>
  <span class="nv">$APP</span> &amp; <span class="nb">disown
  exit </span>0
<span class="k">fi</span>

<span class="c"># workspace ids and names</span>
<span class="nv">WIN_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.id // "-1")'</span> <span class="si">)</span>
<span class="nv">WIN_WS_NAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.name // "")'</span> <span class="si">)</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>

dbg <span class="s2">"Found </span><span class="nv">$APP</span><span class="s2"> addr=</span><span class="nv">$ADDR</span><span class="s2"> ws=</span><span class="nv">$WIN_WS</span><span class="s2"> ws_name='</span><span class="nv">$WIN_WS_NAME</span><span class="s2">' cur_ws=</span><span class="nv">$CUR_WS</span><span class="s2">"</span>

<span class="nv">STATE_FILE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">/</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">.state"</span>

<span class="c"># Helper to re-query where the window is now</span>
where_is<span class="o">()</span> <span class="o">{</span>
  hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.id // "-1")'</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"-1"</span>
<span class="o">}</span>

<span class="c"># 1) 如果窗口在当前 workspace -&gt; 隐藏（move to special）</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span>dbg <span class="s2">"Attempting to hide (current ws)"</span>
  <span class="c"># 保存原 workspace 到状态文件，便于恢复</span>
  <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>

  <span class="c"># 尝试 1: movetoworkspacesilent special,address:ADDR （优雅但可能不支持 special）</span>
  <span class="k">if </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
    </span><span class="nb">sleep </span>0.05
    <span class="nv">NEWWS</span><span class="o">=</span><span class="si">$(</span>where_is<span class="si">)</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$NEWWS</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
      </span>dbg <span class="s2">"Hidden via movetoworkspacesilent to ws=</span><span class="nv">$NEWWS</span><span class="s2">"</span>
      <span class="nb">exit </span>0
    <span class="k">fi
    </span>dbg <span class="s2">"movetoworkspacesilent didn't move the window (no-op)."</span>
  <span class="k">else
    </span>dbg <span class="s2">"movetoworkspacesilent returned non-zero or errored."</span>
  <span class="k">fi</span>

  <span class="c"># 回退方案（可靠）：movetoworkspace special (会切到 special)，再切回原 workspace</span>
  dbg <span class="s2">"Fallback: movetoworkspace special + switch back to </span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  hyprctl dispatch movetoworkspace <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  <span class="c"># 切回之前的 workspace（这样用户感觉没有切换到 special）</span>
  hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  <span class="nb">sleep </span>0.05
  <span class="nv">NEWWS</span><span class="o">=</span><span class="si">$(</span>where_is<span class="si">)</span>
  dbg <span class="s2">"After fallback, window ws=</span><span class="nv">$NEWWS</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 2) 如果窗口不在当前 workspace</span>
<span class="c"># 检查是否在 special（判断 workspace 名或特殊 id）</span>
<span class="nv">IS_SPECIAL</span><span class="o">=</span><span class="nb">false</span>
<span class="c"># 有些 hyprctl 版本会在 .workspace.name / .workspace.special 提供信息；我们尽量容错判断</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"-1"</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_WS_NAME</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-qi</span> <span class="s2">"special"</span><span class="p">;</span> <span class="k">then
  </span><span class="nv">IS_SPECIAL</span><span class="o">=</span><span class="nb">true
</span><span class="k">fi

if</span> <span class="nv">$IS_SPECIAL</span><span class="p">;</span> <span class="k">then
  </span>dbg <span class="s2">"Window appears to be in special workspace -&gt; restoring"</span>

  <span class="c"># 读取之前保存的原 workspace（没有就用当前）</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nv">OLD_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span><span class="si">)</span>
  <span class="k">else
    </span><span class="nv">OLD_WS</span><span class="o">=</span><span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  <span class="k">fi

  </span>dbg <span class="s2">"Trying movetoworkspacesilent back to </span><span class="nv">$OLD_WS</span><span class="s2">"</span>
  <span class="k">if </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
    </span><span class="nb">sleep </span>0.05
    hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$OLD_WS</span><span class="s2">"</span>
    hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
    <span class="nb">rm</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
    dbg <span class="s2">"Restored via movetoworkspacesilent to </span><span class="nv">$OLD_WS</span><span class="s2">"</span>
    <span class="nb">exit </span>0
  <span class="k">fi

  </span>dbg <span class="s2">"Fallback restore: toggling special/showing + movetoworkspace back"</span>
  <span class="c"># best-effort fallback: show special, then move the window back (some versions require non-silent)</span>
  hyprctl dispatch togglespecialworkspace __TEMP <span class="o">||</span> <span class="nb">true
  </span>hyprctl dispatch togglespecialworkspace __TEMP <span class="o">||</span> <span class="nb">true
  </span>hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">true
  </span>hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$OLD_WS</span><span class="s2">"</span>
  hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">true
  rm</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
  dbg <span class="s2">"Fallback restore attempted."</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 最后：窗口在别的普通 workspace -&gt; 直接切过去并 focus</span>
dbg <span class="s2">"Window in other workspace (</span><span class="nv">$WIN_WS</span><span class="s2">) -&gt; switch and focus"</span>
hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span>
hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">exit </span>0

</code></pre></div></div> <h1 id="你要做的快速">你要做的（快速）</h1> <ol> <li> <p>把脚本保存并 <code class="language-plaintext highlighter-rouge">chmod +x ~/scripts/wechat-toggle.sh</code>。</p> </li> <li> <p>在 <code class="language-plaintext highlighter-rouge">hyprland.conf</code> 里绑定（例）： ``` bind = SUPER, W, exec, ~/scripts/wechat-toggle.sh wechat</p> </li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
3. 触发一次隐藏和恢复，若**还不能隐藏**，把这两个命令的输出贴上来（我直接看日志和状态）：
```shell
cat /tmp/hypr_toggle_debug.log
hyprctl clients -j | jq '.[] | {class: .class, address: .address, ws: .workspace.id, name: .workspace.name, floating: .floating}'
hyprctl activeworkspace -j

</code></pre></div></div> <p>（把输出直接复制粘贴到聊天窗口就行）</p> <h1 id="其他注意点常见坑">其他注意点（常见坑）</h1> <ul> <li> <p><code class="language-plaintext highlighter-rouge">jq</code> 必须安装；脚本用了 <code class="language-plaintext highlighter-rouge">hyprctl clients -j</code> 的 JSON 输出来精确定位窗口。</p> </li> <li> <p>有些 Hyprland 版本对 <code class="language-plaintext highlighter-rouge">movetoworkspacesilent</code>（尤其跟 special 配合）行为不一致；脚本里做了回退（先试 silent，再用 movetoworkspace + 切回）。文档和 issue 都有相关提到。<a href="https://wiki.hypr.land/0.18.0beta/Configuring/Dispatchers/?utm_source=chatgpt.com" rel="external nofollow noopener" target="_blank">Hyprland Wiki+1</a></p> </li> <li> <p>special workspace 对浮动/tiling 的处理有特别规则（可能导致窗口在 special 里不能是浮动），因此恢复时需要明确 <code class="language-plaintext highlighter-rouge">movetoworkspace &lt;ws&gt;,address:...</code> 或者 focus 后用 <code class="language-plaintext highlighter-rouge">settiled</code>/<code class="language-plaintext highlighter-rouge">setfloating</code>（这些 dispatcher 在你的 hyprland 版本里是否可用请检查）</p> </li> </ul> <p>先把上面的脚本跑一下，然后把 <code class="language-plaintext highlighter-rouge">/tmp/hypr_toggle_debug.log</code> 和 <code class="language-plaintext highlighter-rouge">hyprctl clients -j | jq ...</code> 的输出贴上来。我会基于真实输出做针对性修正（通常问题就是 “movetoworkspacesilent + special 不生效” 或 “window spec 没写成 address:…” 两类之一）。</p> <p>+++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>现在可以了</p> <h6 id="chatgpt-said">ChatGPT said:</h6> <p>太好了 🎉！那就说明之前的问题确实是 Hyprland 的 <code class="language-plaintext highlighter-rouge">special</code> + <code class="language-plaintext highlighter-rouge">movetoworkspacesilent</code> 行为不一致导致的，现在用带回退逻辑的脚本就稳住了。</p> <p>总结一下你现在的方案：</p> <ul> <li> <p><strong>隐藏</strong>：窗口从当前 workspace 移到 <code class="language-plaintext highlighter-rouge">special</code>，同时保持你原本的 workspace 不切换。</p> </li> <li> <p><strong>恢复</strong>：根据保存的状态把窗口移回原 workspace，并自动聚焦。</p> </li> <li> <p><strong>可靠性</strong>：加了回退逻辑，就算某些 Hyprland 版本对 <code class="language-plaintext highlighter-rouge">movetoworkspacesilent special,...</code> 不支持，也能靠 fallback 正常工作。</p> </li> </ul> <p>要不要我再帮你整理一个更<strong>精简版</strong>的脚本（去掉 debug 和多余分支，方便长期使用），还是保留现在这个带日志的版本（方便以后出问题时排查）？</p> <p>好的</p> <p>👌 那我帮你整理一个 <strong>精简稳定版</strong> 脚本，保留核心逻辑，把调试日志去掉，方便日常使用。</p> <p>保存为 <code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code> 并 <code class="language-plaintext highlighter-rouge">chmod +x</code>：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">STATE_DIR</span><span class="o">=</span><span class="s2">"/tmp/hypr_toggle_states"</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">"</span>

<span class="c"># 找到第一个匹配窗口</span>
<span class="nv">WIN_JSON</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span><span class="si">)</span>
<span class="nv">ADDR</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[] | select((.class // "" | ascii_downcase) == ($app|ascii_downcase)) | .address'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"null"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="c"># 没找到就启动应用（按需改为你的启动命令）</span>
  <span class="nv">$APP</span> &amp; <span class="nb">disown
  exit </span>0
<span class="k">fi

</span><span class="nv">WIN_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | .workspace.id'</span><span class="si">)</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>
<span class="nv">STATE_FILE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">/</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">.state"</span>

<span class="c"># helper: 确认窗口现在在哪个 workspace</span>
where_is<span class="o">()</span> <span class="o">{</span>
  hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.id // "-1")'</span>
<span class="o">}</span>

<span class="c"># 如果窗口在当前 workspace -&gt; 隐藏</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>

  <span class="c"># 优先 silent 方法</span>
  <span class="k">if </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
    </span><span class="nb">exit </span>0
  <span class="k">fi</span>

  <span class="c"># 回退：movetoworkspace special，然后切回原 ws</span>
  hyprctl dispatch movetoworkspace <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 如果窗口在 special -&gt; 恢复</span>
<span class="nv">WIN_WS_NAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.name // "")'</span><span class="si">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"-1"</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_WS_NAME</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-qi</span> <span class="s2">"special"</span><span class="p">;</span> <span class="k">then
  </span><span class="nv">OLD_WS</span><span class="o">=</span><span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  <span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">OLD_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span><span class="si">)</span>

  hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>

  hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$OLD_WS</span><span class="s2">"</span>
  hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">rm</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 否则：窗口在别的 workspace -&gt; 切过去并聚焦</span>
hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span>
hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">exit </span>0

</code></pre></div></div> <h3 id="使用方法-1">使用方法</h3> <ol> <li>保存并赋权： <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x ~/scripts/toggle-app.sh
</code></pre></div> </div> </li> <li>Hyprland 配置里加绑定，例如微信： <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh wechat
</code></pre></div> </div> </li> </ol> <p>（<code class="language-plaintext highlighter-rouge">wechat</code> 要和 <code class="language-plaintext highlighter-rouge">hyprctl clients -j</code> 里 <code class="language-plaintext highlighter-rouge">.class</code> 名一致，比如 <code class="language-plaintext highlighter-rouge">WeChat.exe</code>，可以调一下）</p> <p>这样就是一个干净的「一键隐藏/恢复/启动」脚本了。</p> <p>要不要我再帮你写一个 <strong>通用版本</strong>，支持多个 app（比如 SUPER+F 打开/隐藏 Firefox，SUPER+T 打开/隐藏 Telegram），只用一个脚本就够？</p> <p>好的</p> <p>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>		版本1 
		聊天窗口固定在一个workspace 在其他Workspace按快捷键回到这个workspace
</code></pre></div></div> <p>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>👌 那我给你整理一个 <strong>通用多应用版本</strong>，只用一个脚本就能管理多个应用的「启动 → 隐藏 → 恢复」逻辑。</p> <p>脚本：<code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">STATE_DIR</span><span class="o">=</span><span class="s2">"/tmp/hypr_toggle_states"</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">"</span>

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>   <span class="c"># 第一个参数是应用名，比如 wechat/firefox/telegram</span>
<span class="nv">CMD</span><span class="o">=</span><span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span>   <span class="c"># 第二个参数是启动命令，比如 wechat/firefox/telegram-desktop</span>

<span class="c"># 找窗口</span>
<span class="nv">WIN_JSON</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span><span class="si">)</span>
<span class="nv">ADDR</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[] | select((.class // "" | ascii_downcase) == ($app|ascii_downcase)) | .address'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"null"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="c"># 没找到窗口就启动</span>
  <span class="nb">eval</span> <span class="s2">"</span><span class="nv">$CMD</span><span class="s2"> &amp; disown"</span>
  <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">WIN_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | .workspace.id'</span><span class="si">)</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>
<span class="nv">STATE_FILE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">/</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">.state"</span>

<span class="c"># Helper: 确认窗口在哪个 workspace</span>
where_is<span class="o">()</span> <span class="o">{</span>
  hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.id // "-1")'</span>
<span class="o">}</span>

<span class="c"># 如果窗口在当前 workspace -&gt; 隐藏</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>

  <span class="k">if </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
    </span><span class="nb">exit </span>0
  <span class="k">fi

  </span>hyprctl dispatch movetoworkspace <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 如果窗口在 special -&gt; 恢复</span>
<span class="nv">WIN_WS_NAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.name // "")'</span><span class="si">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"-1"</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_WS_NAME</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-qi</span> <span class="s2">"special"</span><span class="p">;</span> <span class="k">then
  </span><span class="nv">OLD_WS</span><span class="o">=</span><span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span>
  <span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">OLD_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span><span class="si">)</span>

  hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>

  hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$OLD_WS</span><span class="s2">"</span>
  hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">rm</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 窗口在别的 workspace -&gt; 切过去并聚焦</span>
hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span>
hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">exit </span>0

</code></pre></div></div> <h2 id="用法示例">用法示例</h2> <p>假设你要给微信 / Firefox / Telegram 设置快捷键：</p> <h3 id="hyprland-配置">Hyprland 配置</h3> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># SUPER+W -&gt; 微信</span>
<span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh wechat <span class="s2">"wechat"</span>

<span class="c"># SUPER+F -&gt; Firefox</span>
<span class="nb">bind</span> <span class="o">=</span> SUPER, F, <span class="nb">exec</span>, ~/scripts/toggle-app.sh firefox <span class="s2">"firefox"</span>

<span class="c"># SUPER+T -&gt; Telegram</span>
<span class="nb">bind</span> <span class="o">=</span> SUPER, T, <span class="nb">exec</span>, ~/scripts/toggle-app.sh telegram <span class="s2">"telegram-desktop"</span>

</code></pre></div></div> <h2 id="说明">说明</h2> <ul> <li> <p>第一个参数 <code class="language-plaintext highlighter-rouge">$1</code> 用来匹配窗口的 <strong>class 名</strong>（通过 <code class="language-plaintext highlighter-rouge">hyprctl clients -j | jq '.[].class'</code> 查看实际值）。</p> </li> <li> <p>第二个参数 <code class="language-plaintext highlighter-rouge">$2</code> 是应用的启动命令。</p> </li> <li> <p>这样一个脚本就能管理多个应用，配置文件里只需要传不同参数即可。</p> </li> <li> <p>如果你有 Wine/Deepin 的微信，可以写成：</p> <div class="language-shell highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh wechat <span class="s2">"/opt/deepinwine/apps/Deepin-WeChat/wechat"</span>
</code></pre></div> </div> </li> </ul> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>要不要我帮你写一个 <strong>自动配置检测工具</strong>，比如输入应用名就能输出它的 class 和你需要写在绑定里的命令？这样可以快速调试微信这种特殊的 Wine 应用。</p> <p>好的</p> <p>👌 那我帮你写一个 <strong>自动检测工具</strong>，可以快速找出某个应用窗口的 <code class="language-plaintext highlighter-rouge">class</code> 和启动命令，方便配置到脚本里。</p> <p>脚本：<code class="language-plaintext highlighter-rouge">~/scripts/find-app-class.sh</code></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-}</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"用法: </span><span class="nv">$0</span><span class="s2"> &lt;关键字&gt;"</span>
  <span class="nb">echo</span> <span class="s2">"例如: </span><span class="nv">$0</span><span class="s2"> wechat"</span>
  <span class="nb">exit </span>1
<span class="k">fi

</span><span class="nb">echo</span> <span class="s2">"正在查找包含 '</span><span class="nv">$APP</span><span class="s2">' 的窗口..."</span>

hyprctl clients <span class="nt">-j</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[]
  | select(
      (.class // "" | ascii_downcase | contains($app|ascii_downcase))
      or
      (.title // "" | ascii_downcase | contains($app|ascii_downcase))
    )
  | "class=\(.class)  title=\(.title)  address=\(.address)  ws=\(.workspace.id)"'</span>

</code></pre></div></div> <h2 id="用法">用法</h2> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x ~/scripts/find-app-class.sh
~/scripts/find-app-class.sh wechat

</code></pre></div></div> <p>输出示例（不同应用会不一样）：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">class</span><span class="o">=</span>WeChat.exe  <span class="nv">title</span><span class="o">=</span>微信  <span class="nv">address</span><span class="o">=</span>0x55a6f3b  <span class="nv">ws</span><span class="o">=</span>2

</code></pre></div></div> <p>这样你就知道：</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">class</code> 是 <code class="language-plaintext highlighter-rouge">WeChat.exe</code>，那么在 <code class="language-plaintext highlighter-rouge">toggle-app.sh</code> 里传参要写 <code class="language-plaintext highlighter-rouge">WeChat.exe</code>（大小写敏感！）。</p> </li> <li> <p>启动命令则是你平时运行微信的命令，比如 <code class="language-plaintext highlighter-rouge">/opt/deepinwine/apps/Deepin-WeChat/wechat</code>。</p> </li> </ul> <h2 id="配置-hyprland-绑定">配置 Hyprland 绑定</h2> <p>拿到结果后，比如你发现微信的 class 是 <code class="language-plaintext highlighter-rouge">WeChat.exe</code>，就写：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh WeChat.exe <span class="s2">"/opt/deepinwine/apps/Deepin-WeChat/wechat"</span>

</code></pre></div></div> <p>这样脚本才能正确匹配窗口。</p> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>版本2的需求 用法可以使用参考1 快捷键调用时，传连个参数</p> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>我想在一个workspace 按对应快捷键时 wechat窗口就出现在对应的workspace 而不是一直出现在那个初始的workspace</p> <p>明白 ✅<br> 你现在想要的逻辑是：</p> <ul> <li> <p>每个 workspace 上按快捷键 → 微信窗口「瞬移」到这个 workspace（而不是总是回到它最初启动的 workspace）。</p> </li> <li> <p>这样你可以在 <strong>任意 workspace</strong> 上「召唤」微信，它就会出现在你当前所在的 workspace。</p> </li> </ul> <h2 id="思路">思路</h2> <p>核心是把「恢复逻辑」改掉：</p> <ul> <li> <p>以前我们保存了 <strong>最初 workspace</strong> 并把窗口恢复到那里。</p> </li> <li> <p>现在要改成：<strong>恢复时总是移动到当前 workspace</strong>（也就是你按快捷键的 workspace）。</p> </li> </ul> <h2 id="修改版脚本关键变化">修改版脚本（关键变化）</h2> <p><code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">STATE_DIR</span><span class="o">=</span><span class="s2">"/tmp/hypr_toggle_states"</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">"</span>

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">CMD</span><span class="o">=</span><span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span>

<span class="nv">WIN_JSON</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span><span class="si">)</span>
<span class="nv">ADDR</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[] | select((.class // "" | ascii_downcase) == ($app|ascii_downcase)) | .address'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"null"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">eval</span> <span class="s2">"</span><span class="nv">$CMD</span><span class="s2"> &amp; disown"</span>
  <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">WIN_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | .workspace.id'</span><span class="si">)</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>
<span class="nv">STATE_FILE</span><span class="o">=</span><span class="s2">"</span><span class="nv">$STATE_DIR</span><span class="s2">/</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">.state"</span>

<span class="c"># 如果窗口在当前 workspace → 隐藏</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"hidden"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
  hyprctl dispatch movetoworkspacesilent <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    <span class="o">{</span> hyprctl dispatch movetoworkspace <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 如果窗口在 special → 恢复到 **当前 workspace**</span>
<span class="nv">WIN_WS_NAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | (.workspace.name // "")'</span><span class="si">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"-1"</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_WS_NAME</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-qi</span> <span class="s2">"special"</span><span class="p">;</span> <span class="k">then
  </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>

  hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">rm</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$STATE_FILE</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 如果窗口在其他 workspace → 移动到 **当前 workspace**</span>
hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
  hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>

hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>

</code></pre></div></div> <h2 id="使用方式">使用方式</h2> <p>还是和之前一样：</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh WeChat.exe <span class="s2">"/opt/deepinwine/apps/Deepin-WeChat/wechat"</span>

</code></pre></div></div> <p>效果就是：</p> <ul> <li> <p>在任意 workspace 按下快捷键，</p> <ul> <li> <p>如果微信在前台 → 隐藏到 special</p> </li> <li> <p>如果微信被隐藏 → 恢复到「当前 workspace」</p> </li> <li> <p>如果微信在别的 workspace → 把它移到「当前 workspace」</p> </li> </ul> </li> </ul> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>		                 版本 2
	聊天窗口不固定在一个workspace 
	在其他Workspace按快捷键 聊天窗口 会在对应的workspace出现
</code></pre></div></div> <p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>如果是隐藏的状态 按快捷键 也要出现在当前workspace 而不是之前的workspace</p> <p>对的 👍 你要的逻辑是：</p> <ul> <li> <p><strong>隐藏时</strong> → 放到 <code class="language-plaintext highlighter-rouge">special</code></p> </li> <li> <p><strong>再按快捷键恢复时</strong> → 永远回到「当前 workspace」而不是之前启动的那个</p> </li> </ul> <p>上次脚本里已经部分改了，但恢复时我还保留了检查 <code class="language-plaintext highlighter-rouge">WIN_WS_NAME</code> 的逻辑（可能导致回到旧 workspace）。<br> 咱们直接彻底改掉：只要在 <code class="language-plaintext highlighter-rouge">special</code> → 一律移到 <strong>当前 workspace</strong>。</p> <h3 id="脚本更新版">脚本更新版</h3> <p><code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code></p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">CMD</span><span class="o">=</span><span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span>

<span class="nv">WIN_JSON</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span><span class="si">)</span>
<span class="nv">ADDR</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[] | select((.class // "" | ascii_downcase) == ($app|ascii_downcase)) | .address'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"null"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="c"># 没有运行 → 启动</span>
  <span class="nb">eval</span> <span class="s2">"</span><span class="nv">$CMD</span><span class="s2"> &amp; disown"</span>
  <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">WIN_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | .workspace.id'</span><span class="si">)</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>

<span class="c"># 情况 1: 在当前 workspace → 隐藏到 special</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    <span class="o">{</span> hyprctl dispatch movetoworkspace <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 情况 2: 在 special → 恢复到当前 workspace</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"-1"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 情况 3: 在别的 workspace → 直接拉到当前 workspace</span>
hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
  hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>

</code></pre></div></div> <h3 id="绑定示例">绑定示例</h3> <p><code class="language-plaintext highlighter-rouge">hyprland.conf</code>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">bind</span> <span class="o">=</span> SUPER, W, <span class="nb">exec</span>, ~/scripts/toggle-app.sh WeChat.exe <span class="s2">"/opt/deepinwine/apps/Deepin-WeChat/wechat"</span>

</code></pre></div></div> <h3 id="效果">效果</h3> <ul> <li> <p><strong>在当前 workspace</strong> → 按下快捷键 → 隐藏到 <code class="language-plaintext highlighter-rouge">special</code></p> </li> <li> <p><strong>再按快捷键</strong> → 从 <code class="language-plaintext highlighter-rouge">special</code> 拉回来 → <strong>当前 workspace</strong></p> </li> <li> <p><strong>在别的 workspace</strong> → 按快捷键 → 微信窗口会「瞬移」过来</p> </li> </ul> <p>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p> <p>要不要我帮你扩展一下，把 APP class 名 + 启动命令 配置到一个数组里，这样同一个脚本就能管理多个应用（比如微信、Telegram、Slack、QQ）？</p> <p>好的</p> <p>👌 那我们做一个「多应用通用版」的脚本，你只需要在数组里配置好应用的 <strong>class 名称</strong> 和 <strong>启动命令</strong>，就能用同一份 <code class="language-plaintext highlighter-rouge">toggle-app.sh</code> 来控制微信、Telegram、Slack、QQ 等。</p> <hr> <h2 id="脚本scriptstoggle-appsh">脚本：<code class="language-plaintext highlighter-rouge">~/scripts/toggle-app.sh</code> </h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="c"># 在这里配置应用列表：class 名称 =&gt; 启动命令</span>
<span class="nb">declare</span> <span class="nt">-A</span> <span class="nv">apps</span><span class="o">=(</span>
  <span class="o">[</span><span class="s2">"WeChat.exe"</span><span class="o">]=</span><span class="s2">"/opt/deepinwine/apps/Deepin-WeChat/wechat"</span>
  <span class="o">[</span><span class="s2">"telegram-desktop"</span><span class="o">]=</span><span class="s2">"telegram-desktop"</span>
  <span class="o">[</span><span class="s2">"slack"</span><span class="o">]=</span><span class="s2">"slack"</span>
  <span class="o">[</span><span class="s2">"qq"</span><span class="o">]=</span><span class="s2">"qq"</span>
<span class="o">)</span>

<span class="nv">APP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="k">${</span><span class="nv">apps</span><span class="p">[</span><span class="nv">$APP</span><span class="p">]+isset</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"未知应用: </span><span class="nv">$APP</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"可用: </span><span class="k">${</span><span class="p">!apps[@]</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">exit </span>1
<span class="k">fi

</span><span class="nv">CMD</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">apps</span><span class="p">[</span><span class="nv">$APP</span><span class="p">]</span><span class="k">}</span><span class="s2">"</span>

<span class="nv">WIN_JSON</span><span class="o">=</span><span class="si">$(</span>hyprctl clients <span class="nt">-j</span><span class="si">)</span>
<span class="nv">ADDR</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> app <span class="s2">"</span><span class="nv">$APP</span><span class="s2">"</span> <span class="s1">'
  .[] | select((.class // "" | ascii_downcase) == ($app|ascii_downcase)) | .address'</span> | <span class="nb">head</span> <span class="nt">-n1</span><span class="si">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"null"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="c"># 没有运行 → 启动</span>
  <span class="nb">eval</span> <span class="s2">"</span><span class="nv">$CMD</span><span class="s2"> &amp; disown"</span>
  <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">WIN_WS</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$WIN_JSON</span><span class="s2">"</span> | jq <span class="nt">-r</span> <span class="nt">--arg</span> addr <span class="s2">"</span><span class="nv">$ADDR</span><span class="s2">"</span> <span class="s1">'.[] | select(.address==$addr) | .workspace.id'</span><span class="si">)</span>
<span class="nv">CUR_WS</span><span class="o">=</span><span class="si">$(</span>hyprctl activeworkspace <span class="nt">-j</span> | jq <span class="nt">-r</span> .id<span class="si">)</span>

<span class="c"># 情况 1: 在当前 workspace → 隐藏到 special</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="nt">-eq</span> <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    <span class="o">{</span> hyprctl dispatch movetoworkspace <span class="s2">"special,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> hyprctl dispatch workspace <span class="s2">"</span><span class="nv">$CUR_WS</span><span class="s2">"</span><span class="p">;</span> <span class="o">}</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 情况 2: 在 special → 恢复到当前 workspace</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$WIN_WS</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"-1"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span>hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
    hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">exit </span>0
<span class="k">fi</span>

<span class="c"># 情况 3: 在别的 workspace → 直接拉到当前 workspace</span>
hyprctl dispatch movetoworkspacesilent <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
  hyprctl dispatch movetoworkspace <span class="s2">"</span><span class="k">${</span><span class="nv">CUR_WS</span><span class="k">}</span><span class="s2">,address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
hyprctl dispatch focuswindow <span class="s2">"address:</span><span class="k">${</span><span class="nv">ADDR</span><span class="k">}</span><span class="s2">"</span>
</code></pre></div></div> <hr> <h2 id="使用方式绑定快捷键">使用方式（绑定快捷键）</h2> <p>在 <code class="language-plaintext highlighter-rouge">hyprland.conf</code> 里加：</p> <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 微信
</span><span class="py">bind</span> <span class="p">=</span> <span class="s">SUPER, W, exec, ~/scripts/toggle-app.sh WeChat.exe</span>
<span class="c"># Telegram
</span><span class="py">bind</span> <span class="p">=</span> <span class="s">SUPER, T, exec, ~/scripts/toggle-app.sh telegram-desktop</span>
<span class="c"># Slack
</span><span class="py">bind</span> <span class="p">=</span> <span class="s">SUPER, S, exec, ~/scripts/toggle-app.sh slack</span>
<span class="c"># QQ
</span><span class="py">bind</span> <span class="p">=</span> <span class="s">SUPER, Q, exec, ~/scripts/toggle-app.sh qq</span>
</code></pre></div></div> <hr> <h2 id="效果-1">效果</h2> <ul> <li> <p>按下对应快捷键：</p> <ul> <li> <p>如果应用没启动 → 启动</p> </li> <li> <p>如果在当前 workspace → 隐藏到 <code class="language-plaintext highlighter-rouge">special</code></p> </li> <li> <p>如果在 <code class="language-plaintext highlighter-rouge">special</code> → 拉回 <strong>当前 workspace</strong></p> </li> <li> <p>如果在别的 workspace → 拉到 <strong>当前 workspace</strong></p> </li> </ul> </li> </ul> <hr> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/" target="_blank" rel="external nofollow noopener">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2" target="_blank" rel="external nofollow noopener">Displaying External Posts on Your al-folio Blog</a> <svg width="1rem" height="1rem" viewbox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"> <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/Hyprlan%E5%BE%AE%E4%BF%A1%E9%80%9A%E7%9F%A5/">Hyprlan微信通知</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/zero%E6%B5%8B%E8%AF%95/">Zero测试</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/plotly/">a post with plotly.js</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Kevin Feng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>